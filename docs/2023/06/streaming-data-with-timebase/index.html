<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Streaming Market Data with TimeBase - FOSS Trading</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Streaming Market Data with TimeBase" />
<meta property="og:description" content="This is the first post of a series on using TimeBase to stream real-time market data. TimeBase is a high performance event-based time series database and message broker. I used it on a proprietary trading desk that made markets in futures, and currently use it to build and test equity trading strategies. It was released as open-source in February 2021.
Preface I am not affiliated with the company that created and maintains TimeBase (Deltix, now EPAM)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.fosstrading.com/2023/06/streaming-data-with-timebase/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-06-19T12:14:00-05:00" />
<meta property="article:modified_time" content="2023-06-19T12:14:00-05:00" />

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/fosstrading.css"><link rel="stylesheet" href="/syntax.css">

	<link rel="shortcut icon" href="/favicon.ico">
		
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LT26X44HDL"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-LT26X44HDL', { 'anonymize_ip': false });
}
</script>

</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="FOSS Trading" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">FOSS Trading</div>
					<div class="logo__tagline">Algorithmic Trading with Free Open Source Software</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">Blog</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/page/disclosures/">
				
				<span class="menu__text">Disclosures</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/page/enterprise/">
				
				<span class="menu__text">For Enterprise</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Streaming Market Data with TimeBase</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2023-06-19T12:14:00-05:00">June 19, 2023</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/Articles/" rel="category">Articles</a>
	</span>
</div></div>
		</header>
		<div class="content post__content clearfix">
			<p>This is the first post of a series on using <a href="https://timebase.info/">TimeBase</a> to stream real-time market data. TimeBase is a high performance event-based time series database and message broker. I used it on a proprietary trading desk that made markets in futures, and currently use it to build and test equity trading strategies. It was <a href="https://github.com/finos/TimeBase-CE/">released as open-source</a> in February 2021.</p>
<h3 id="preface">Preface</h3>
<p>I am not affiliated with the company that created and maintains TimeBase (Deltix, now EPAM). I&rsquo;m not currently compensated by them in any way for promoting their product. I&rsquo;m merely a happy user who is excited that TimeBase is open source and I can show you how to do some cool stuff with it.</p>
<h3 id="whats-your-problem">What&rsquo;s Your Problem?</h3>
<p><a href="https://timebase.info/">TimeBase</a> addresses several key needs in automated trading. You need to process large amounts of real-time market data. This includes trades, best bid/offer, and/or the entire limit order book. You use this data to calculate indicators/features, determine when and where to place orders, monitoring unrealized P&amp;L, and monitoring/managing risk of your positions.</p>
<p>All data in the trading system needs to be processed quickly and absolutely must be processed in strict time order. This is not trivial when you need to interleave data from multiple sources (e.g. exchanges and the trading system itself).
The <a href="https://medium.com/prooftrading/proof-engineering-the-algorithmic-trading-platform-b9c2f195433d#d545">System Architecture</a> section of &ldquo;The Algorithmic Trading Platform&rdquo; by Prerak Sanghvi describes the benefits of using a strictly time-sequenced stream of events. To summarize:</p>
<ul>
<li>Synchronized: every system component always receives the same data in the same order.</li>
<li>Observable: the system is deterministic and can be debugged offline by replaying the data.</li>
<li>Auditable: You can re-create the state of the system at any point in time.</li>
<li>Streamlined: Tasks like logging and persisting to disk can be delegated to components that are off the critical path.</li>
</ul>
<p>The data also needs be stored for analysis and debugging. Analysis includes things like running backtests, post-trade evaluation, and investigating market behavior. <a href="https://medium.com/prooftrading/selecting-a-database-for-an-algorithmic-trading-system-2d25f9648d02">&ldquo;Selecting a Database for an Algorithmic Trading System&rdquo;
</a> by Prerak Sanghvi discusses the necessary components of a time-series database for algorithmic trading. To summarize:</p>
<ul>
<li>Fast data ingest: millions of records per second (quote data can be 100+ million records per day)</li>
<li>Ability to process large amounts of historical data for patterns and trends</li>
<li>Time series operations and real-time analytics (e.g. window functions, aggregations, as-of joins)</li>
<li>Expressive query language</li>
<li>Optimized on-disk layout</li>
</ul>
<h3 id="timebase-vs-alternatives">TimeBase vs Alternatives</h3>
<p>Why use TimeBase instead of other open-source projects like <a href="https://www.rabbitmq.com/">RabbitMQ</a>, <a href="https://kafka.apache.org/">Kafka</a>, <a href="https://www.influxdata.com/">InfluxDB</a>, <a href="https://www.timescale.com/">TimeScaleDB</a>, or <a href="https://clickhouse.com/">ClickHouse</a>? The main reason is that TimeBase is both a <a href="https://en.wikipedia.org/wiki/Message_broker">message broker</a> <em>and</em> a <a href="https://en.wikipedia.org/wiki/Time_series_database">time-series database</a>. The TimeBase website has its own <a href="https://timebase.info/why-timebase/">&ldquo;Why TimeBase&rdquo; page</a> and pages that compare popular <a href="https://timebase.info/why-timebase/tsdb-comparison.html">time-series databases</a> and <a href="https://timebase.info/why-timebase/message-brokers-comparison.html">message brokers</a>. Here&rsquo;s a summary of the benefits of TimeBase from those pages:</p>
<ul>
<li>Based on configuration, it supports microsecond latencies or the ability to handle millions of messages per second on commodity hardware.</li>
<li>Enforces stream schemas with heterogeneous and potentially complex <a href="https://kb.timebase.info/community/overview/messages">message structures</a>.</li>
<li>The same <a href="https://kb.timebase.info/community/development/libs">APIs</a> can be used to stream real-time data <em>and</em> replay historical data.</li>
<li>Able to <a href="https://kb.timebase.info/community/technology/replication/replication_intro">replicate data</a> to other TimeBase instances or applications.</li>
<li>The open-source community edition has multiple crypto exchange data connectors. The enterprise edition has 50+ built-in data connectors.</li>
</ul>
<h3 id="timebase-structure">TimeBase Structure</h3>
<p>This is a high-level summary of the <a href="https://timebase.info/architecture.html">TimeBase architecture page</a>.</p>
<p><strong>Data connectors</strong> handle connecting to external data sources and translating their data into the TimeBase format. There are many open source <a href="https://github.com/epam/TimebaseCryptoConnectors">crypto exchange data connectors</a>. The enterprise edition has another 50+ data connectors to all major exchanges and many data vendors.</p>
<p><strong>The message broker</strong> provides a <a href="https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern">publish/subscribe</a> pattern to write/read streaming data. The data is processed via readers and writers to <a href="https://kb.timebase.info/community/overview/streams">streams</a>.</p>
<p>Writers can only write to one stream. Readers can consume multiple streams simultaneously and the messages from every stream are interleaved so that every message consumed is always in guaranteed time order regardless of which stream they come from. It is extremely important that every consumer receives data strictly sequenced by time!</p>
<p>There are two types of streams, durable and transient. Durable streams are persisted to disk. Transient streams are only in memory and can be <em>lossy</em> or <em>lossless</em>.</p>
<ul>
<li>
<p>Writers to <em>lossy</em> streams are not blocked by slow readers, so slow readers may not receive every message but always receive the next available message once they finish processing a message.</p>
</li>
<li>
<p>Writers to <em>lossless</em> streams are blocked by slow readers, so every reader always receives every message and every reader can only process data as fast as the slowest reader.</p>
</li>
</ul>
<p><strong>The database</strong> handles reading/writing data from/to disk, importing and exporting data, replicating data to other applications, and can aggregate data to regular bars. It has a query language (<a href="https://kb.timebase.info/community/development/qql/QQL%205.5/qql-tut-intro">QQL</a>) you can use to extract, filter, aggregate, and transform data in streams.</p>
<p>There&rsquo;s also an open-source <a href="https://kb.timebase.info/community/development/tools/Web%20Admin/admin_config_ce">Web Administrator</a> you can use to manipulate streams (create, delete, edit, import/export). It also allows you to view data, including monitoring live data streaming in to the database.</p>
<h3 id="whats-next">What&rsquo;s Next?</h3>
<p>Later posts in this series will cover at least the topics below. Please leave a comment or contact me with any other things you would like to see!</p>
<ul>
<li>Building and running TimeBase from source/Docker</li>
<li>Building and running the Web Administrator from source/Docker</li>
<li>Setting up a data connector</li>
<li>Introduction to the Web Administrator (viewing/monitoring data, import/export)</li>
<li>Introduction to QQL, the quant query language</li>
</ul>
<p>Thanks to <a href="https://robotjames.com/">TheRobotJames</a> for helpful feedback, and to <a href="https://twitter.com/gestaltu">Adam Butler</a> for encouraging me to write more!</p>
<div class="container" role="main">
  <div class="row">
    <h3>Other Posts in this TimeBase Series</h3>
    <ul>
      <li><a href="/2023/06/streaming-data-with-timebase/">Streaming Market Data with TimeBase</a></li>
      <li><a href="/2023/06/running-timebase-in-docker/">Running TimeBase in Docker</a></li>
    </ul>
  </div>
</div>

<div class="container" role="main">
  <div class="row">
    <hr>
    <p>If you love using my open-source work (e.g.
      <a href="https://cran.r-project.org/package=quantmod">quantmod</a>,
      <a href="https://cran.r-project.org/package=TTR">TTR</a>,
      <a href="https://cran.r-project.org/package=xts">xts</a>,
      <a href="https://cran.r-project.org/package=IBrokers">IBrokers</a>,
      <a href="https://cran.r-project.org/package=microbenchmark">microbenchmark</a>,
      <a href="https://github.com/braverock/blotter/">blotter</a>,
      <a href="https://github.com/braverock/quantstrat/">quantstrat</a>,
      etc.), you can give back by <a href="https://github.com/sponsors/joshuaulrich/">sponsoring me on GitHub</a>. I truly appreciate anything you&rsquo;re willing and able to give!</p>
  </div>
</div>


		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/Data/" rel="tag">Data</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/TimeBase/" rel="tag">TimeBase</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>



<section class="comments">
	<div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "foss-trading" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<label>
			<input class="widget-search__field" type="search" placeholder="SEARCH…" value="" name="q" aria-label="SEARCH…">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="https://blog.fosstrading.com/">
	</form>
</div>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style type="text/css">
#mc_embed_signup{background:#fff; clear:left; font:12px Helvetica,Arial,sans-serif;}
 
</style>
<div id="mc_embed_signup">
    <form action="https://fosstrading.us9.list-manage.com/subscribe/post?u=3b596c57e89d8db5b99daf4ff&amp;id=85bd253834&amp;f_id=00fb1ce1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_self">
        <div id="mc_embed_signup_scroll">
        <h2>Subscribe to email updates</h2>
        <div class="indicates-required"><span class="asterisk">*</span> indicates required</div>
<div class="mc-field-group">
<label for="mce-EMAIL">Email Address  <span class="asterisk">*</span>
</label>
<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required>
<span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
</div>
<div class="mc-field-group">
<label for="mce-FNAME">First Name </label>
<input type="text" value="" name="FNAME" class="" id="mce-FNAME">
<span id="mce-FNAME-HELPERTEXT" class="helper_text"></span>
</div>
<div class="mc-field-group">
<label for="mce-LNAME">Last Name </label>
<input type="text" value="" name="LNAME" class="" id="mce-LNAME">
<span id="mce-LNAME-HELPERTEXT" class="helper_text"></span>
</div>
<div class="mc-field-group input-group">
    <strong>Interests </strong>
    <ul><li>
    <input type="checkbox" value="1" name="group[53492][1]" id="mce-group[53492]-53492-0" checked>
    <label for="mce-group[53492]-53492-0">R package releases</label>
</li>
<li>
    <input type="checkbox" value="2" name="group[53492][2]" id="mce-group[53492]-53492-1" checked>
    <label for="mce-group[53492]-53492-1">Everything else</label>
</li>
</ul>
    <span id="mce-group[53492]-HELPERTEXT" class="helper_text"></span>
</div>
<div id="mce-responses" class="clear foot">
<div class="response" id="mce-error-response" style="display:none"></div>
<div class="response" id="mce-success-response" style="display:none"></div>
</div>    
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_3b596c57e89d8db5b99daf4ff_85bd253834" tabindex="-1" value=""></div>
        <div class="optionalParent">
            <div class="clear foot">
                <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
                <p class="brandingLogo"><a href="http://eepurl.com/ijAV-n" title="Mailchimp - email marketing made easy and fun"><img src="https://eep.io/mc-cdn-images/template_images/branding_logo_text_dark_dtp.svg"></a></p>
            </div>
        </div>
    </div>
</form>
</div>


<div>
    <a title="CSI Data" href="https://www.csicheckout.com/cgi-bin/ua_order_form_nw.pl?referrer=JU" target="_blank">
      <img class="csi-banner" src="/csi-banner.jpg" width="160" height="312">
    </a>
    <p>
</div>

<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/2023/12/adaptive-asset-allocation-replication/">Adaptive Asset Allocation Replication</a></li>
			<li class="widget__item"><a class="widget__link" href="/2023/08/quantmod-0-4-25-on-cran/">quantmod_0.4.25 on CRAN</a></li>
			<li class="widget__item"><a class="widget__link" href="/2023/06/running-timebase-in-docker/">Running TimeBase in Docker</a></li>
			<li class="widget__item"><a class="widget__link" href="/2023/06/streaming-data-with-timebase/">Streaming Market Data with TimeBase</a></li>
			<li class="widget__item"><a class="widget__link" href="/2023/05/getsymbols-rebooted/">getSymbols Rebooted</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/search/label/API/" title="API">API</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Code/" title="Code">Code</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/DEoptim/" title="DEoptim">DEoptim</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Data/" title="Data">Data</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Drawdown/" title="Drawdown">Drawdown</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Events/" title="Events">Events</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Examples/" title="Examples">Examples</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Excel/" title="Excel">Excel</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Historical-Data/" title="Historical Data">Historical Data</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/IBrokers/" title="IBrokers">IBrokers</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Interactive-Brokers/" title="Interactive Brokers">Interactive Brokers</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/LSPM/" title="LSPM">LSPM</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/PortfolioAnalytics/" title="PortfolioAnalytics">PortfolioAnalytics</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/R/" title="R">R</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Releases/" title="Releases">Releases</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Reviews/" title="Reviews">Reviews</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/TTR/" title="TTR">TTR</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/TimeBase/" title="TimeBase">TimeBase</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/blotter/" title="blotter">blotter</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/quantmod/" title="quantmod">quantmod</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/quantstrat/" title="quantstrat">quantstrat</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/xts/" title="xts">xts</a>
	</div>
</div><div>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-7427704313601198"
       data-ad-slot="6372007789"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>

</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 FOSS Trading.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>