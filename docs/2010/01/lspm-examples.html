<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>LSPM Examples - FOSS Trading</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta property="og:title" content="LSPM Examples" />
<meta property="og:description" content="I have received several requests for additional LSPM documentation over the past couple days and a couple months ago I promised an introduction to LSPM.
In this long-overdue post, I will show how to optimize a Leverage Space Portfolio with the LSPM package. Please use the comments to let me know what you would like to see next.
Some copious notes before we get to the code:
These examples are based on revision 26 31 from r-forge and will not work under earlier revisions (and may not work with later revisions)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.fosstrading.com/2010/01/lspm-examples.html" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2010-01-02T15:35:00-06:00" />
<meta property="article:modified_time" content="2010-01-02T15:35:00-06:00" />


	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/fosstrading.css"><link rel="stylesheet" href="/syntax.css">
	<link rel="shortcut icon" href="/favicon.ico">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-3314405-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    <script data-ad-client="ca-pub-7427704313601198" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="FOSS Trading" rel="home">
				<div class="logo__title">FOSS Trading</div>
				<div class="logo__tagline">Algorithmic Trading with Free Open Source Software</div>
			</a>
		</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">Blog</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/page/disclosures/">
				
				<span class="menu__text">Disclosures</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/page/enterprise/">
				
				<span class="menu__text">For Enterprise</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">LSPM Examples</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2010-01-02T15:35:00-06:00">January 02, 2010</time></div></div>
		</header><div class="content post__content clearfix">
			<p>I have received several requests for additional <a href="https://r-forge.r-project.org/projects/lspm">LSPM</a> documentation over the past couple days and a couple months ago <a href="http://blog.fosstrading.com/2009/09/update.html">I promised an introduction</a> to LSPM.</p>
<p>In this long-overdue post, I will show how to optimize a Leverage Space Portfolio with the LSPM package.  Please use the comments to let me know what you would like to see next.</p>
<p>Some copious notes before we get to the code:</p>
<p>These examples are based on revision <del>26</del> 31 from r-forge and will not work under earlier revisions (and may not work with later revisions). LSPM is still in <strong>very</strong> alpha status.  Expect things to change, perhaps significantly.</p>
<p>These examples were run using <a href="http://cran.r-project.org/src/contrib/Archive/DEoptim/DEoptim_1.3-3.tar.gz">DEoptim_1.3-3</a> (and LSPM revision 26 depends on that version) code from DEoptim_1.3-3 that has been bundled inside LSPM.  We are working with the DEoptim authors to address issues with more recent versions of DEoptim.  LSPM will un-bundle and use the most recent version of DEoptim as soon as the issues are resolved.</p>
<p>The first two examples are taken from <a href="http://www.amazon.com/gp/product/0470455950?ie=UTF8&amp;tag=fotr09-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0470455950">Vince, Ralph (2009). The Leverage Space Trading Model. New York: John Wiley &amp; Sons, Inc.</a><img src="http://www.assoc-amazon.com/e/ir?t=fotr09-20&amp;l=as2&amp;o=1&amp;a=0470455950" alt=""> The results will not match the book because of differences between optimization via DEoptim and Ralph&rsquo;s genetic algorithm implementation.  Ralph believes his genetic algorithm is getting hung up on a local maximum, whereas DEoptim is closer to the global solution.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Load the LSPM package  </span>
<span class="nf">library</span><span class="p">(</span><span class="n">LSPM</span><span class="p">)</span>  
  
<span class="c1"># Multiple strategy example (data found on pp. 84-87)  </span>
<span class="n">trades</span> <span class="o">&lt;-</span> <span class="nf">cbind</span><span class="p">(</span>  
 <span class="nf">c</span><span class="p">(</span><span class="m">-150</span><span class="p">,</span><span class="m">-45.33</span><span class="p">,</span><span class="m">-45.33</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">13</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="m">79.67</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">136</span><span class="p">),</span>  
 <span class="nf">c</span><span class="p">(</span><span class="m">253</span><span class="p">,</span><span class="m">-1000</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">-64.43</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">253</span><span class="p">,</span><span class="m">253</span><span class="p">,</span><span class="m">448</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">-64.43</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">253</span><span class="p">),</span>  
 <span class="nf">c</span><span class="p">(</span><span class="m">533</span><span class="p">,</span><span class="m">220.14</span><span class="p">,</span><span class="m">220.14</span><span class="p">,</span><span class="m">-500</span><span class="p">,</span><span class="m">533</span><span class="p">,</span><span class="m">220.14</span><span class="p">,</span><span class="m">799</span><span class="p">,</span><span class="m">220.14</span><span class="p">,</span><span class="m">-325</span><span class="p">,</span><span class="m">220.14</span><span class="p">,</span><span class="m">533</span><span class="p">,</span><span class="m">220.14</span><span class="p">)</span> <span class="p">)</span>  
<span class="n">probs</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.076923077</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="m">0.153846154</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.076923077</span><span class="p">,</span><span class="m">9</span><span class="p">))</span>  

<span class="c1"># Create a Leverage Space Portfolio object  </span>
<span class="n">port</span> <span class="o">&lt;-</span> <span class="nf">lsp</span><span class="p">(</span><span class="n">trades</span><span class="p">,</span><span class="n">probs</span><span class="p">)</span>  
  
<span class="c1"># DEoptim parameters (see ?DEoptim)  </span>
<span class="c1"># NP=30        (10 * number of strategies)  </span>
<span class="c1"># itermax=100  (maximum number of iterations)  </span>
<span class="n">DEctrl</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="n">NP</span><span class="o">=</span><span class="m">30</span><span class="p">,</span><span class="n">itermax</span><span class="o">=</span><span class="m">100</span><span class="p">)</span>  
  
<span class="c1"># Unconstrainted Optimal f (results on p. 87)  </span>
<span class="n">res</span> <span class="o">&lt;-</span> <span class="nf">optimalf</span><span class="p">(</span><span class="n">port</span><span class="p">,</span><span class="n">control</span><span class="o">=</span><span class="n">DEctrl</span><span class="p">)</span>  
  
<span class="c1"># Drawdown-constrained Optimal f (results on p. 137)  </span>
<span class="c1"># Since horizon=12, this optimization will take about an hour  </span>
<span class="n">res</span> <span class="o">&lt;-</span> <span class="nf">optimalf</span><span class="p">(</span><span class="n">port</span><span class="p">,</span><span class="n">probDrawdown</span><span class="p">,</span><span class="m">0.1</span><span class="p">,</span><span class="n">DD</span><span class="o">=</span><span class="m">0.2</span><span class="p">,</span><span class="n">horizon</span><span class="o">=</span><span class="m">12</span><span class="p">,</span><span class="n">calc.max</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="n">control</span><span class="o">=</span><span class="n">DEctrl</span><span class="p">)</span>  
  
<span class="c1"># Ruin-constrained Optimal f  </span>
<span class="n">res</span> <span class="o">&lt;-</span> <span class="nf">optimalf</span><span class="p">(</span><span class="n">port</span><span class="p">,</span><span class="n">probRuin</span><span class="p">,</span><span class="m">0.1</span><span class="p">,</span><span class="n">DD</span><span class="o">=</span><span class="m">0.2</span><span class="p">,</span><span class="n">horizon</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="n">control</span><span class="o">=</span><span class="n">DEctrl</span><span class="p">)</span>  
  
<span class="c1"># Drawdown-constrained Optimal f  </span>
<span class="n">res</span> <span class="o">&lt;-</span> <span class="nf">optimalf</span><span class="p">(</span><span class="n">port</span><span class="p">,</span><span class="n">probDrawdown</span><span class="p">,</span><span class="m">0.1</span><span class="p">,</span><span class="n">DD</span><span class="o">=</span><span class="m">0.2</span><span class="p">,</span><span class="n">horizon</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="n">control</span><span class="o">=</span><span class="n">DEctrl</span><span class="p">)</span>
</code></pre></div>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/Examples/" rel="tag">Examples</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/LSPM/" rel="tag">LSPM</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/2009/11/tactical-asset-allocation-using-blotter.html" rel="prev">
			<span class="post-nav__caption">«&thinsp;Previous</span>
			<p class="post-nav__post-title">Tactical asset allocation using blotter</p>
		</a>
	</div>
	<div class="post-nav__item post-nav__item--next">
		<a class="post-nav__link" href="/2010/01/lspm-with-snow.html" rel="next">
			<span class="post-nav__caption">Next&thinsp;»</span>
			<p class="post-nav__post-title">LSPM with snow</p>
		</a>
	</div>
</nav>

<section class="comments">
	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "foss-trading" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<label>
			<input class="widget-search__field" type="search" placeholder="SEARCH..." value="" name="q" aria-label="SEARCH...">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="https://blog.fosstrading.com/" />
	</form>
</div>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style type="text/css">
#mc_embed_signup{background:#fff; clear:left; font:12px Helvetica,Arial,sans-serif;}
 
</style>
<div id="mc_embed_signup">
    <form action="https://fosstrading.us9.list-manage.com/subscribe/post?u=3b596c57e89d8db5b99daf4ff&amp;id=85bd253834&amp;f_id=00fb1ce1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_self">
        <div id="mc_embed_signup_scroll">
        <h2>Subscribe to email updates</h2>
        <div class="indicates-required"><span class="asterisk">*</span> indicates required</div>
<div class="mc-field-group">
<label for="mce-EMAIL">Email Address  <span class="asterisk">*</span>
</label>
<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required>
<span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
</div>
<div class="mc-field-group">
<label for="mce-FNAME">First Name </label>
<input type="text" value="" name="FNAME" class="" id="mce-FNAME">
<span id="mce-FNAME-HELPERTEXT" class="helper_text"></span>
</div>
<div class="mc-field-group">
<label for="mce-LNAME">Last Name </label>
<input type="text" value="" name="LNAME" class="" id="mce-LNAME">
<span id="mce-LNAME-HELPERTEXT" class="helper_text"></span>
</div>
<div class="mc-field-group input-group">
    <strong>Interests </strong>
    <ul><li>
    <input type="checkbox" value="1" name="group[53492][1]" id="mce-group[53492]-53492-0" checked>
    <label for="mce-group[53492]-53492-0">CRAN package releases</label>
</li>
<li>
    <input type="checkbox" value="2" name="group[53492][2]" id="mce-group[53492]-53492-1" checked>
    <label for="mce-group[53492]-53492-1">Everything else</label>
</li>
</ul>
    <span id="mce-group[53492]-HELPERTEXT" class="helper_text"></span>
</div>
<div id="mce-responses" class="clear foot">
<div class="response" id="mce-error-response" style="display:none"></div>
<div class="response" id="mce-success-response" style="display:none"></div>
</div>    
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_3b596c57e89d8db5b99daf4ff_85bd253834" tabindex="-1" value=""></div>
        <div class="optionalParent">
            <div class="clear foot">
                <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
                <p class="brandingLogo"><a href="http://eepurl.com/ijAV-n" title="Mailchimp - email marketing made easy and fun"><img src="https://eep.io/mc-cdn-images/template_images/branding_logo_text_dark_dtp.svg"></a></p>
            </div>
        </div>
    </div>
</form>
</div>


<div>
    <a title="CSI Data" href="https://www.csicheckout.com/cgi-bin/ua_order_form_nw.pl?referrer=JU" target="_blank">
      <img class="csi-banner" src="/csi-banner.jpg" width="160" height="312">
    </a>
    <p>
</div>

<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/2023/02/xts-0-13-0-on-cran.html">xts_0.13.0 on CRAN</a></li>
			<li class="widget__item"><a class="widget__link" href="/2022/10/xts-0-12-2-on-cran.html">xts_0.12.2 on CRAN</a></li>
			<li class="widget__item"><a class="widget__link" href="/2020/09/xlf-rolling-mean-correlation.html">Mean rolling correlation of XLF constituents</a></li>
			<li class="widget__item"><a class="widget__link" href="/2020/09/xts-0-12-1-on-cran.html">xts_0.12.1 on CRAN</a></li>
			<li class="widget__item"><a class="widget__link" href="/2020/09/ttr-0-24-2-on-cran.html">TTR_0.24.2 on CRAN</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/search/label/API.html" title="API">API</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Code.html" title="Code">Code</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/DEoptim.html" title="DEoptim">DEoptim</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Data.html" title="Data">Data</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Drawdown.html" title="Drawdown">Drawdown</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Events.html" title="Events">Events</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Examples.html" title="Examples">Examples</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Excel.html" title="Excel">Excel</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/HIstorical-Data.html" title="HIstorical Data">HIstorical Data</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/IBrokers.html" title="IBrokers">IBrokers</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Interactive-Brokers.html" title="Interactive Brokers">Interactive Brokers</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/LSPM.html" title="LSPM">LSPM</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/PortfolioAnalytics.html" title="PortfolioAnalytics">PortfolioAnalytics</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/R.html" title="R">R</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Releases.html" title="Releases">Releases</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/Reviews.html" title="Reviews">Reviews</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/TTR.html" title="TTR">TTR</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/blotter.html" title="blotter">blotter</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/quantmod.html" title="quantmod">quantmod</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/quantstrat.html" title="quantstrat">quantstrat</a>
		<a class="widget-taglist__link widget__link btn" href="/search/label/xts.html" title="xts">xts</a>
	</div>
</div><div>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-7427704313601198"
       data-ad-slot="6372007789"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>

</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 FOSS Trading.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
